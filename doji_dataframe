import pandas as pd
import talib
import numpy as np
import datetime

df = pd.read_csv("C:\\Users\\ansible\\Documents\\nearusdt.csv")

date=df["date"]
open1=df["open"]
close=df["close"]
low=df["low"]
close=df["close"]
high=df["high"]
volume=df["volume"]
newdf = pd.DataFrame(({"date":date,"open":open1,"high":high,"low":low,"close":close}))

#newdf.set_index('date',inplace=True)

doji = talib.CDLDOJI(open1, high, low, close)

### Need to combine DOJI and NEWDF ___while___ replacing the date column from epoch to normal
def dateformat(epochxxx):
    epoch = int(epochxxx)/1000
    my_time=datetime.datetime.fromtimestamp(epoch).strftime('%c')
    return my_time

leng=len(newdf["date"])
newdates = []
x1 = newdf['date']
for i in range(0,leng):
    x2 = dateformat(x1[i])
    newdates.append(x2)
    


fp=pd.DataFrame({"date":newdates,"open":open1,"close":close,"high":high,"low":low, "volume":volume,"DOJI":doji})
#fp.set_index('date',inplace=True)
print(fp)
